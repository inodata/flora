{% extends 'InodataFloraBundle::base_edit.html.twig' %}

{#
    probar si arregla la inclusion de javascripts utilizados por genemu bundle y otros

    {% extends 'SonataAdminBundle::standard_layout.html.twig' %}

    {% block javascripts %}
       {{ parent() }}
       {% if form is defined %}{{ form_javascript(form) }}{% endif %}
    {% endblock %}

    {% block stylesheets %}
       {{ parent() }}
       {% if form is defined %}{{ form_stylesheet(form) }}{% endif %}
    {% endblock %}
#}


{% block stylesheets %}
	{{ parent() }}
	{% stylesheets '@InodataFloraBundle/Resources/public/css/select2.css'
                   '@InodataFloraBundle/Resources/public/css/main.css' %}
		<link rel="stylesheet" href="{{ asset_url }}" />
	{% endstylesheets %}

{% endblock %}
{% block javascripts %}
	{{ parent() }}	
	<script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
	<script src="{{ path('fos_js_routing_js', {"callback": "fos.Router.setData"}) }}"></script>
	{% javascripts "@InodataFloraBundle/Resources/public/js/select2.js" 
				   "@InodataFloraBundle/Resources/public/js/select2_locale_es.js"
				   "@InodataFloraBundle/Resources/public/js/order_admin.js"
				   "@InodataFloraBundle/Resources/public/js/lang/es.js"
                   "@InodataFloraBundle/Resources/public/js/print.js"
                   "@InodataFloraBundle/Resources/public/js/customer_admin.js"
	%}
	<script type="text/javascript" src="{{ asset_url }}" ></script>
	{% endjavascripts %}
{% endblock %}

{% block sonata_fieldsets %}
    <div class="tab-content">
        {% for name, form_group in admin.formgroups %}            
            {% if name == "tab.invoice" %}
                <div class="tab-pane {% if loop.first %} active{% endif %}" id="{{ admin.uniqid }}_{{ name|sonata_slugify }}">
                    {{ block('sonata_fieldset') }}
                    {% if admin.id(object) %}
                    	{% embed 'InodataFloraBundle:Order:payment_note.html.twig' %}{% endembed %}
                    	{% if object.hasInvoice==1 %}
                    		{% embed 'InodataFloraBundle:Order:invoice.html.twig' %}{% endembed %}
                    	{% endif %}
                    {% else %}
                    	<div class="no-invoice-msg">Para facturar, primero debe crear la orden.</div>
                    {% endif %}
                    {% embed 'InodataFloraBundle:Order:card.html.twig' %}{% endembed %}
                </div>
            {% else %}
                <div class="tab-pane {% if loop.first %} active{% endif %}" id="{{ admin.uniqid }}_{{ name|sonata_slugify }}">
                    {{ block('sonata_fieldset') }}
                    {% embed 'InodataFloraBundle:Order:products_table.html.twig' %}{% endembed %}
                </div>
            {% endif %}
        {% endfor %}
    </div>
{% endblock %}
{% block sonata_formactions %}
	{{ parent() }}
	{% if admin.id(object) %}
		<a class="btn btn-print-note" href="javascript:void()">
			<i class="icon-print"></i>{{ 'button.print_note'|trans({}, 'InodataFloraBundle') }}
		</a>
		<a class="btn btn-print-invoice" href="javascript:void()">
			<i class="icon-print"></i>{{ 'button.print_invoice'|trans({}, 'InodataFloraBundle') }}
		</a>
	{% endif %}
{% endblock %}